# ml_Assignment4

## рЃърЃарЃЮрЃћрЃЦрЃбрЃўрЃА рЃљрЃдрЃгрЃћрЃарЃљ

рЃљрЃЏ рЃърЃарЃЮрЃћрЃЦрЃбрЃерЃў рЃерЃћрЃАрЃарЃБрЃџрЃћрЃЉрЃБрЃџрЃўрЃљ **Challenges in Representation Learning: Facial Expression Recognition Challenge** Kaggle рЃЦрЃЮрЃЏрЃцрЃћрЃЌрЃўрЃерЃћрЃюрЃўрЃА рЃљрЃЏрЃЮрЃфрЃљрЃюрЃљ. рЃърЃарЃЮрЃћрЃЦрЃбрЃўрЃА рЃЏрЃўрЃќрЃљрЃюрЃўрЃљ рЃАрЃ«рЃЋрЃљрЃЊрЃљрЃАрЃ«рЃЋрЃљ рЃюрЃћрЃўрЃарЃЮрЃюрЃБрЃџрЃў рЃЦрЃАрЃћрЃџрЃўрЃА рЃљрЃарЃЦрЃўрЃбрЃћрЃЦрЃбрЃБрЃарЃћрЃЉрЃўрЃА рЃњрЃљрЃбрЃћрЃАрЃбрЃЋрЃљ.

## ­ЪћЌ рЃџрЃўрЃюрЃЎрЃћрЃЉрЃў

- **GitHub Repository**: [https://github.com/gval0/ml_Assignment4](https://github.com/gval0/ml_Assignment4)
- **Wandb Project**: [facial-expression-recognition](https://wandb.ai/gval0/facial-expression-recognition)
- **Kaggle Competition**: [Facial Expression Recognition Challenge](https://www.kaggle.com/c/challenges-in-representation-learning-facial-expression-recognition-challenge)

## ­ЪЈЌ№ИЈ рЃърЃарЃЮрЃћрЃЦрЃбрЃўрЃА рЃАрЃбрЃарЃБрЃЦрЃбрЃБрЃарЃљ

```
ml_Assignment4/
РћюРћђРћђ src/
Рћѓ   РћюРћђРћђ models/
Рћѓ   Рћѓ   РћюРћђРћђ simple_cnn.py      # рЃЏрЃљрЃарЃбрЃўрЃЋрЃў CNN
Рћѓ   Рћѓ   РћюРћђРћђ deeper_cnn.py      # рЃдрЃарЃЏрЃљ CNN
Рћѓ   Рћѓ   РћћРћђРћђ resnet_variants.py # ResNet рЃЋрЃљрЃарЃўрЃљрЃюрЃбрЃћрЃЉрЃў
Рћѓ   РћюРћђРћђ training/
Рћѓ   Рћѓ   РћюРћђРћђ trainer.py         # рЃАрЃљрЃАрЃгрЃљрЃЋрЃџрЃЮ рЃЎрЃџрЃљрЃАрЃў
Рћѓ   Рћѓ   РћћРћђРћђ utils.py          # рЃЊрЃљрЃЏрЃ«рЃЏрЃљрЃарЃћ рЃцрЃБрЃюрЃЦрЃфрЃўрЃћрЃЉрЃў
Рћѓ   РћюРћђРћђ evaluation/
Рћѓ   Рћѓ   РћћРћђРћђ metrics.py        # рЃерЃћрЃцрЃљрЃАрЃћрЃЉрЃўрЃА рЃЏрЃћрЃбрЃарЃўрЃЎрЃћрЃЉрЃў
Рћѓ   РћћРћђРћђ data_loader.py        # рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃўрЃА рЃЕрЃљрЃбрЃЋрЃўрЃарЃЌрЃЋрЃљ
РћюРћђРћђ notebooks/
Рћѓ   РћюРћђРћђ 01_data_exploration.ipynb    # рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃўрЃА рЃљрЃюрЃљрЃџрЃўрЃќрЃў
Рћѓ   РћюРћђРћђ 02_baseline_models.ipynb     # рЃАрЃљрЃЉрЃљрЃќрЃўрЃАрЃЮ рЃЏрЃЮрЃЊрЃћрЃџрЃћрЃЉрЃў
Рћѓ   РћюРћђРћђ 03_model_iterations.ipynb    # рЃЏрЃЮрЃЊрЃћрЃџрЃўрЃА рЃўрЃбрЃћрЃарЃљрЃфрЃўрЃћрЃЉрЃў
Рћѓ   РћћРћђРћђ 04_final_analysis.ipynb      # рЃАрЃљрЃЉрЃЮрЃџрЃЮрЃЮ рЃљрЃюрЃљрЃџрЃўрЃќрЃў
РћюРћђРћђ experiments/                     # рЃерЃћрЃюрЃљрЃ«рЃБрЃџрЃў рЃЏрЃЮрЃЊрЃћрЃџрЃћрЃЉрЃў
РћћРћђРћђ README.md
```

## ­ЪДф рЃЕрЃљрЃбрЃљрЃарЃћрЃЉрЃБрЃџрЃў рЃћрЃЦрЃАрЃърЃћрЃарЃўрЃЏрЃћрЃюрЃбрЃћрЃЉрЃў

### рЃАрЃћрЃарЃўрЃљ 1: рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃўрЃА рЃЊрЃљрЃЏрЃБрЃерЃљрЃЋрЃћрЃЉрЃљ (Data Augmentation)
- **Exp1a**: рЃАрЃљрЃЉрЃљрЃќрЃўрЃАрЃЮ рЃЏрЃЮрЃЊрЃћрЃџрЃў no augmentation Рєњ **55.67%** рЃАрЃўрЃќрЃБрЃАрЃбрЃћ
- **Exp1b**: рЃЏрЃЮрЃЊрЃћрЃџрЃў with augmentation Рєњ **57.06%** рЃАрЃўрЃќрЃБрЃАрЃбрЃћ
- **рЃЊрЃљрЃАрЃЎрЃЋрЃюрЃљ**: рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃўрЃА рЃќрЃарЃЊрЃљрЃЏ рЃњрЃљрЃљрЃБрЃЏрЃ»рЃЮрЃЉрЃћрЃАрЃљ рЃерЃћрЃЊрЃћрЃњрЃў 1.4%-рЃўрЃЌ

### рЃАрЃћрЃарЃўрЃљ 2: рЃљрЃарЃЦрЃўрЃбрЃћрЃЦрЃбрЃБрЃарЃћрЃЉрЃўрЃА рЃерЃћрЃЊрЃљрЃарЃћрЃЉрЃљ
- **SimpleCNN**: 4.74M рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃў Рєњ **57.59%** рЃАрЃўрЃќрЃБрЃАрЃбрЃћ
- **DeepCNN**: 1.70M рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃў Рєњ **25.83%** рЃАрЃўрЃќрЃБрЃАрЃбрЃћ (underfitting)
- **ResNetFER**: 2.78M рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃў Рєњ **59.31%** рЃќрЃБрЃАрЃбрЃЮрЃЉрЃљ РГљ

### рЃАрЃћрЃарЃўрЃљ 3: рЃАрЃгрЃљрЃЋрЃџрЃўрЃА рЃбрЃћрЃЏрЃърЃўрЃА рЃЮрЃърЃбрЃўрЃЏрЃўрЃќрЃљрЃфрЃўрЃљ (Learning Rate)
ResNetFER-рЃќрЃћ рЃАрЃ«рЃЋрЃљрЃЊрЃљрЃАрЃ«рЃЋрЃљ LR-рЃћрЃЉрЃўрЃА рЃбрЃћрЃАрЃбрЃўрЃарЃћрЃЉрЃљ:
- **1e-4**: 46.47% (рЃюрЃћрЃџрЃў рЃАрЃгрЃљрЃЋрЃџрЃћрЃЉрЃљ)
- **1e-3**: 57.13% 
- **1e-2**: 58.96% РГљ

### рЃАрЃћрЃарЃўрЃљ 4: рЃЮрЃърЃбрЃўрЃЏрЃљрЃўрЃќрЃћрЃарЃћрЃЉрЃўрЃА рЃерЃћрЃЊрЃљрЃарЃћрЃЉрЃљ
- **Adam**: 56.99% рЃАрЃўрЃќрЃБрЃАрЃбрЃћ
- **SGD**: 48.16% рЃАрЃўрЃќрЃБрЃАрЃбрЃћ
- **рЃЊрЃљрЃАрЃЎрЃЋрЃюрЃљ**: Adam рЃБрЃЎрЃћрЃЌрЃћрЃАрЃў рЃерЃћрЃЊрЃћрЃњрЃў рЃљрЃЕрЃЋрЃћрЃюрЃљ

### рЃАрЃћрЃарЃўрЃљ 5: рЃарЃћрЃњрЃБрЃџрЃљрЃарЃўрЃќрЃљрЃфрЃўрЃљ (Dropout)
- **Dropout 0.3**: 58.28% РГљ
- **Dropout 0.5**: 57.15%  
- **Dropout 0.7**: 57.45%

## ­ЪЈє рЃАрЃљрЃЉрЃЮрЃџрЃЮрЃЮ рЃерЃћрЃЊрЃћрЃњрЃћрЃЉрЃў

**рЃАрЃљрЃБрЃЎрЃћрЃЌрЃћрЃАрЃЮ рЃЏрЃЮрЃЊрЃћрЃџрЃў**:
- **рЃљрЃарЃЦрЃўрЃбрЃћрЃЦрЃбрЃБрЃарЃљ**: ResNetFER
- **рЃќрЃБрЃАрЃбрЃЮрЃЉрЃљ**: **58.28%**
- **рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃў**: 2,778,311
- **рЃ░рЃўрЃърЃћрЃарЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃў**:
  - Learning Rate: 0.01
  - Optimizer: Adam
  - Dropout: 0.3
  - Data Augmentation: True

## ­ЪЊѕ рЃФрЃўрЃарЃўрЃЌрЃљрЃЊрЃў рЃЊрЃљрЃЎрЃЋрЃўрЃарЃЋрЃћрЃЉрЃћрЃЉрЃў

### 1. **Overfitting-рЃўрЃА рЃљрЃюрЃљрЃџрЃўрЃќрЃў**
- ResNetFER-рЃЏрЃљ рЃљрЃЕрЃЋрЃћрЃюрЃљ рЃФрЃџрЃўрЃћрЃарЃў overfitting (Train: 95% vs Val: 58%)
- Dropout-рЃЏрЃљ рЃЊрЃљрЃћрЃ«рЃЏрЃљрЃарЃљ overfitting-рЃўрЃА рЃерЃћрЃЏрЃфрЃўрЃарЃћрЃЉрЃљрЃерЃў
- Data Augmentation-рЃЏрЃљ рЃљрЃАрЃћрЃЋрЃћ рЃерЃћрЃљрЃЏрЃфрЃўрЃарЃљ overfitting

### 2. **Underfitting-рЃўрЃА рЃљрЃюрЃљрЃџрЃўрЃќрЃў**  
- DeepCNN рЃљрЃЕрЃЋрЃћрЃюрЃћрЃЉрЃЊрЃљ underfitting-рЃА (25% рЃќрЃБрЃАрЃбрЃЮрЃЉрЃљ)
- рЃЏрЃўрЃќрЃћрЃќрЃў: рЃФрЃљрЃџрЃўрЃљрЃю рЃдрЃарЃЏрЃљ рЃљрЃарЃЦрЃўрЃбрЃћрЃЦрЃбрЃБрЃарЃљ рЃЏрЃфрЃўрЃарЃћ рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА
- Gradient vanishing рЃърЃарЃЮрЃЉрЃџрЃћрЃЏрЃљ

### 3. **рЃЏрЃЮрЃЊрЃћрЃџрЃўрЃА рЃќрЃЮрЃЏрЃўрЃАрЃљ рЃЊрЃљ рЃерЃћрЃАрЃарЃБрЃџрЃћрЃЉрЃўрЃА рЃЎрЃљрЃЋрЃерЃўрЃарЃў**
- SimpleCNN (4.7M): 57.59%
- ResNetFER (2.8M): 59.31%
- **рЃЊрЃљрЃАрЃЎрЃЋрЃюрЃљ**: рЃЏрЃћрЃбрЃў рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃў РЅа рЃБрЃЎрЃћрЃЌрЃћрЃАрЃў рЃерЃћрЃЊрЃћрЃњрЃў

## ­ЪЊі Wandb Tracking

рЃДрЃЋрЃћрЃџрЃљ рЃћрЃЦрЃАрЃърЃћрЃарЃўрЃЏрЃћрЃюрЃбрЃў рЃџрЃЮрЃњрЃўрЃарЃћрЃЉрЃБрЃџрЃўрЃљ Wandb-рЃќрЃћ:
- **рЃърЃарЃЮрЃћрЃЦрЃбрЃў**: `facial-expression-recognition`
- **рЃАрЃБрЃџ Runs**: 14+ рЃћрЃЦрЃАрЃърЃћрЃарЃўрЃЏрЃћрЃюрЃбрЃў
- **рЃЏрЃћрЃбрЃарЃўрЃЎрЃћрЃЉрЃў**: accuracy, loss, learning curves, confusion matrix

### рЃџрЃЮрЃњрЃўрЃарЃћрЃЉрЃБрЃџрЃў рЃЏрЃћрЃбрЃарЃўрЃЎрЃћрЃЉрЃў:
- Train/Validation Accuracy & Loss
- Train-Validation Gap (overfitting рЃўрЃюрЃЊрЃўрЃЎрЃљрЃбрЃЮрЃарЃў)
- Model Parameters рЃарЃљрЃЮрЃЊрЃћрЃюрЃЮрЃЉрЃљ
- Training Time
- Hyperparameters

## ­ЪЊЂ рЃцрЃљрЃўрЃџрЃћрЃЉрЃўрЃА рЃАрЃбрЃарЃБрЃЦрЃбрЃБрЃарЃљ

| рЃцрЃљрЃўрЃџрЃў | рЃљрЃдрЃгрЃћрЃарЃљ |
|--------|---------|
| `01_data_exploration.ipynb` | рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃўрЃА рЃљрЃюрЃљрЃџрЃўрЃќрЃў рЃЊрЃљ рЃЋрЃўрЃќрЃБрЃљрЃџрЃўрЃќрЃљрЃфрЃўрЃљ |
| `02_baseline_models.ipynb` | рЃАрЃљрЃЉрЃљрЃќрЃўрЃАрЃЮ рЃЏрЃЮрЃЊрЃћрЃџрЃћрЃЉрЃўрЃА рЃўрЃЏрЃърЃџрЃћрЃЏрЃћрЃюрЃбрЃљрЃфрЃўрЃљ |
| `03_model_iterations.ipynb` | рЃДрЃЋрЃћрЃџрЃљ рЃћрЃЦрЃАрЃърЃћрЃарЃўрЃЏрЃћрЃюрЃбрЃўрЃА рЃАрЃўрЃАрЃбрЃћрЃЏрЃљрЃбрЃБрЃарЃў рЃЕрЃљрЃбрЃљрЃарЃћрЃЉрЃљ |
| `04_final_analysis.ipynb` | рЃАрЃљрЃЉрЃЮрЃџрЃЮрЃЮ рЃерЃћрЃЊрЃћрЃњрЃћрЃЉрЃўрЃА рЃљрЃюрЃљрЃџрЃўрЃќрЃў |

## ­ЪјЊ рЃФрЃўрЃарЃўрЃЌрЃљрЃЊрЃў рЃЊрЃљрЃАрЃЎрЃЋрЃюрЃћрЃЉрЃў

1. **ResNet рЃљрЃарЃЦрЃўрЃбрЃћрЃЦрЃбрЃБрЃарЃљ** рЃБрЃЎрЃћрЃЌрЃћрЃАрЃўрЃљ рЃЏрЃљрЃарЃбрЃўрЃЋ CNN-рЃќрЃћ FER рЃљрЃЏрЃЮрЃфрЃљрЃюрЃўрЃАрЃЌрЃЋрЃўрЃА
2. **Data Augmentation** рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЋрЃюрЃљрЃЊ рЃљрЃЏрЃфрЃўрЃарЃћрЃЉрЃА overfitting-рЃА
3. **Learning Rate 0.01** рЃЮрЃърЃбрЃўрЃЏрЃљрЃџрЃБрЃарЃўрЃљ Adam optimizer-рЃЌрЃљрЃю
4. **Dropout 0.3** рЃЮрЃърЃбрЃўрЃЏрЃљрЃџрЃБрЃарЃў рЃЎрЃЮрЃЏрЃърЃарЃЮрЃЏрЃўрЃАрЃўрЃљ accuracy-рЃАрЃљ рЃЊрЃљ regularization-рЃА рЃерЃЮрЃарЃўрЃА
5. **Overfitting** рЃФрЃўрЃарЃўрЃЌрЃљрЃЊрЃў рЃърЃарЃЮрЃЉрЃџрЃћрЃЏрЃљрЃљ - рЃЏрЃЮрЃЊрЃћрЃџрЃў рЃќрЃћрЃЊрЃЏрЃћрЃбрЃљрЃЊ рЃАрЃгрЃљрЃЋрЃџрЃЮрЃЉрЃА рЃАрЃљрЃАрЃгрЃљрЃЋрЃџрЃЮ рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃА